{
  "templateName": "Bexio Dashboard - Template Professionnel",
  "version": "2.1",
  "description": "Template Power BI complet pour l'analyse des donn√©es Bexio avec 12 endpoints, 55+ KPIs et visualisations pr√™tes √† l'emploi",
  "author": "BSCO Dashboard",
  "lastUpdated": "2025-11-11",

  "dataModel": {
    "tables": [
      {
        "name": "Dashboard",
        "description": "Feuille de synth√®se avec tous les KPIs calcul√©s",
        "type": "dimension"
      },
      {
        "name": "Contacts",
        "description": "Clients et fournisseurs",
        "type": "dimension",
        "primaryKey": "id"
      },
      {
        "name": "Factures",
        "description": "Toutes les factures avec statuts",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "Offres",
        "description": "Devis et propositions commerciales",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "Commandes",
        "description": "Commandes clients valid√©es",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "Notes de Cr√©dit",
        "description": "Avoirs clients",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "Projets",
        "description": "Gestion de projets",
        "type": "dimension",
        "primaryKey": "id"
      },
      {
        "name": "Temps",
        "description": "Heures track√©es par projet",
        "type": "fact"
      },
      {
        "name": "Articles",
        "description": "Catalogue produits/services",
        "type": "dimension",
        "primaryKey": "id"
      },
      {
        "name": "Paiements",
        "description": "Transactions financi√®res re√ßues",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "D√©penses",
        "description": "Frais et co√ªts d'exploitation",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "Notes",
        "description": "Communications et historique CRM",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "T√¢ches",
        "description": "To-dos et workflow",
        "type": "fact",
        "primaryKey": "id"
      },
      {
        "name": "Top Clients",
        "description": "Top 10 clients par CA",
        "type": "dimension"
      },
      {
        "name": "Tendances",
        "description": "CA mensuel sur 12 mois",
        "type": "fact"
      },
      {
        "name": "Analyse Factures",
        "description": "Factures enrichies avec statuts d√©taill√©s",
        "type": "fact"
      }
    ],

    "relationships": [
      {
        "from": "Factures",
        "fromColumn": "contact_id",
        "to": "Contacts",
        "toColumn": "id",
        "cardinality": "many-to-one",
        "crossFilterDirection": "single"
      },
      {
        "from": "Offres",
        "fromColumn": "contact_id",
        "to": "Contacts",
        "toColumn": "id",
        "cardinality": "many-to-one",
        "crossFilterDirection": "single"
      },
      {
        "from": "Commandes",
        "fromColumn": "contact_id",
        "to": "Contacts",
        "toColumn": "id",
        "cardinality": "many-to-one",
        "crossFilterDirection": "single"
      },
      {
        "from": "Notes de Cr√©dit",
        "fromColumn": "Client ID",
        "to": "Contacts",
        "toColumn": "id",
        "cardinality": "many-to-one",
        "crossFilterDirection": "single"
      },
      {
        "from": "Projets",
        "fromColumn": "contact_id",
        "to": "Contacts",
        "toColumn": "id",
        "cardinality": "many-to-one",
        "crossFilterDirection": "single"
      },
      {
        "from": "Paiements",
        "fromColumn": "Contact ID",
        "to": "Contacts",
        "toColumn": "id",
        "cardinality": "many-to-one",
        "crossFilterDirection": "single"
      },
      {
        "from": "D√©penses",
        "fromColumn": "Fournisseur ID",
        "to": "Contacts",
        "toColumn": "id",
        "cardinality": "many-to-one",
        "crossFilterDirection": "single"
      }
    ]
  },

  "daxMeasures": {
    "financial": [
      {
        "name": "CA Total",
        "formula": "SUM(Factures[Montant])",
        "description": "Chiffre d'affaires total",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "CA Pay√©",
        "formula": "CALCULATE(SUM(Factures[Montant]), Factures[Statut] = \"Pay√©e\")",
        "description": "CA des factures pay√©es",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "CA En Attente",
        "formula": "CALCULATE(SUM(Factures[Montant]), Factures[Statut] = \"En attente\")",
        "description": "CA des factures en attente de paiement",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "CA En Retard",
        "formula": "CALCULATE(SUM(Factures[Montant]), Factures[Statut] = \"En retard\")",
        "description": "CA des factures en retard",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "Total Notes de Cr√©dit",
        "formula": "SUM('Notes de Cr√©dit'[Montant])",
        "description": "Total des avoirs √©mis",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "CA Net",
        "formula": "[CA Total] - [Total Notes de Cr√©dit]",
        "description": "CA net apr√®s notes de cr√©dit",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "Total Paiements",
        "formula": "SUM(Paiements[Montant])",
        "description": "Total des paiements encaiss√©s",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "Paiements En Attente",
        "formula": "CALCULATE(SUM(Paiements[Montant]), Paiements[En attente] = \"Oui\")",
        "description": "Paiements non encore encaiss√©s",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "Total D√©penses",
        "formula": "SUM(D√©penses[Montant])",
        "description": "Total des frais et d√©penses",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "Marge Brute",
        "formula": "[CA Net] - [Total D√©penses]",
        "description": "Marge apr√®s d√©penses",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "% Marge",
        "formula": "DIVIDE([Marge Brute], [CA Net], 0)",
        "description": "Pourcentage de marge",
        "formatString": "0.00%"
      },
      {
        "name": "DSO (Jours)",
        "formula": "DIVIDE([CA En Attente] + [CA En Retard], [CA Total] / 365, 0)",
        "description": "Days Sales Outstanding - d√©lai moyen d'encaissement",
        "formatString": "0"
      }
    ],

    "sales": [
      {
        "name": "Valeur Offres",
        "formula": "SUM(Offres[Montant])",
        "description": "Valeur totale des offres",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "Offres Accept√©es",
        "formula": "CALCULATE(COUNT(Offres[ID]), Offres[Statut ID] = 8)",
        "description": "Nombre d'offres accept√©es",
        "formatString": "0"
      },
      {
        "name": "Taux Conversion",
        "formula": "DIVIDE([Offres Accept√©es], COUNT(Offres[ID]), 0)",
        "description": "Taux de conversion des offres",
        "formatString": "0.00%"
      },
      {
        "name": "Panier Moyen",
        "formula": "DIVIDE([CA Total], DISTINCTCOUNT(Factures[Client ID]), 0)",
        "description": "CA moyen par client",
        "formatString": "#,##0.00 CHF"
      },
      {
        "name": "Nb Clients Actifs",
        "formula": "DISTINCTCOUNT(Factures[Client ID])",
        "description": "Nombre de clients ayant g√©n√©r√© du CA",
        "formatString": "0"
      }
    ],

    "operations": [
      {
        "name": "Heures Totales",
        "formula": "SUM(Temps[duration])",
        "description": "Total des heures track√©es",
        "formatString": "#,##0.0"
      },
      {
        "name": "Heures Facturables",
        "formula": "CALCULATE(SUM(Temps[duration]), Temps[allowable_bill] = TRUE())",
        "description": "Heures facturables",
        "formatString": "#,##0.0"
      },
      {
        "name": "Taux Facturation",
        "formula": "DIVIDE([Heures Facturables], [Heures Totales], 0)",
        "description": "Pourcentage d'heures facturables",
        "formatString": "0.00%"
      },
      {
        "name": "Projets Actifs",
        "formula": "CALCULATE(COUNT(Projets[id]), Projets[pr_state_id] IN {1, 2})",
        "description": "Nombre de projets en cours",
        "formatString": "0"
      },
      {
        "name": "T√¢ches Ouvertes",
        "formula": "CALCULATE(COUNT(T√¢ches[ID]), T√¢ches[Statut] IN {\"Ouvert\", \"En cours\"})",
        "description": "T√¢ches non termin√©es",
        "formatString": "0"
      }
    ]
  },

  "reportPages": [
    {
      "name": "üìä Dashboard Principal",
      "description": "Vue d'ensemble avec KPIs principaux",
      "visualizations": [
        {
          "type": "Card",
          "measure": "CA Net",
          "position": { "x": 0, "y": 0, "width": 3, "height": 2 }
        },
        {
          "type": "Card",
          "measure": "Marge Brute",
          "position": { "x": 3, "y": 0, "width": 3, "height": 2 }
        },
        {
          "type": "Card",
          "measure": "% Marge",
          "position": { "x": 6, "y": 0, "width": 3, "height": 2 }
        },
        {
          "type": "Card",
          "measure": "Nb Clients Actifs",
          "position": { "x": 9, "y": 0, "width": 3, "height": 2 }
        },
        {
          "type": "Line Chart",
          "title": "√âvolution CA Mensuel",
          "xAxis": "Tendances[Mois]",
          "yAxis": "Tendances[Chiffre d'affaires]",
          "position": { "x": 0, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Bar Chart",
          "title": "Top 10 Clients",
          "axis": "Top Clients[Nom]",
          "values": "Top Clients[Chiffre d'affaires]",
          "position": { "x": 6, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Donut Chart",
          "title": "R√©partition CA par Statut",
          "legend": "Factures[Statut]",
          "values": "Factures[Montant]",
          "position": { "x": 0, "y": 6, "width": 4, "height": 3 }
        },
        {
          "type": "Gauge",
          "title": "Taux de Conversion",
          "measure": "Taux Conversion",
          "target": "0.30",
          "position": { "x": 4, "y": 6, "width": 4, "height": 3 }
        },
        {
          "type": "Table",
          "title": "Factures R√©centes",
          "columns": ["N¬∞ Facture", "Client", "Montant", "Statut", "Date √©ch√©ance"],
          "rows": 10,
          "position": { "x": 8, "y": 6, "width": 4, "height": 3 }
        }
      ]
    },
    {
      "name": "üí∞ Analyse Financi√®re",
      "description": "D√©tails financiers et tr√©sorerie",
      "visualizations": [
        {
          "type": "Multi-Card",
          "measures": ["CA Total", "CA Pay√©", "CA En Attente", "CA En Retard", "Total Paiements", "Total D√©penses"],
          "position": { "x": 0, "y": 0, "width": 12, "height": 2 }
        },
        {
          "type": "Waterfall Chart",
          "title": "√âvolution Tr√©sorerie",
          "categories": ["CA Total", "Notes de Cr√©dit", "CA Net", "D√©penses", "Marge Brute"],
          "position": { "x": 0, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Column Chart",
          "title": "CA par Statut",
          "xAxis": "Factures[Statut]",
          "yAxis": "[CA Total]",
          "position": { "x": 6, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Matrix",
          "title": "Analyse Mensuelle D√©taill√©e",
          "rows": "Tendances[Mois]",
          "values": ["[CA Total]", "[Total Paiements]", "[Total D√©penses]", "[Marge Brute]"],
          "position": { "x": 0, "y": 6, "width": 12, "height": 3 }
        }
      ]
    },
    {
      "name": "üë• Analyse Clients",
      "description": "Segmentation et comportement clients",
      "visualizations": [
        {
          "type": "Card",
          "measure": "Nb Clients Actifs",
          "position": { "x": 0, "y": 0, "width": 3, "height": 2 }
        },
        {
          "type": "Card",
          "measure": "Panier Moyen",
          "position": { "x": 3, "y": 0, "width": 3, "height": 2 }
        },
        {
          "type": "Treemap",
          "title": "CA par Client",
          "group": "Contacts[name_1]",
          "values": "[CA Total]",
          "position": { "x": 0, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Map",
          "title": "R√©partition G√©ographique",
          "location": "Contacts[city]",
          "size": "[CA Total]",
          "position": { "x": 6, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Table",
          "title": "Top Clients D√©taill√©",
          "columns": ["Nom", "Ville", "Email", "CA", "Nb Factures"],
          "position": { "x": 0, "y": 6, "width": 12, "height": 3 }
        }
      ]
    },
    {
      "name": "üìÅ Projets & Op√©rations",
      "description": "Suivi projets, temps et t√¢ches",
      "visualizations": [
        {
          "type": "Card",
          "measure": "Projets Actifs",
          "position": { "x": 0, "y": 0, "width": 2, "height": 2 }
        },
        {
          "type": "Card",
          "measure": "Heures Totales",
          "position": { "x": 2, "y": 0, "width": 2, "height": 2 }
        },
        {
          "type": "Card",
          "measure": "Taux Facturation",
          "position": { "x": 4, "y": 0, "width": 2, "height": 2 }
        },
        {
          "type": "Card",
          "measure": "T√¢ches Ouvertes",
          "position": { "x": 6, "y": 0, "width": 2, "height": 2 }
        },
        {
          "type": "Bar Chart",
          "title": "Heures par Projet",
          "axis": "Projets[name]",
          "values": "[Heures Totales]",
          "position": { "x": 0, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Stacked Column Chart",
          "title": "Heures Facturables vs Non Facturables",
          "xAxis": "Projets[name]",
          "yAxis": ["[Heures Facturables]", "[Heures Totales]"],
          "position": { "x": 6, "y": 2, "width": 6, "height": 4 }
        },
        {
          "type": "Kanban",
          "title": "T√¢ches par Statut",
          "columns": "T√¢ches[Statut]",
          "cards": "T√¢ches[Titre]",
          "position": { "x": 0, "y": 6, "width": 12, "height": 3 }
        }
      ]
    }
  ],

  "theme": {
    "name": "Professional Bexio",
    "colors": {
      "primary": "#6366F1",
      "secondary": "#EC4899",
      "success": "#10B981",
      "warning": "#F59E0B",
      "danger": "#EF4444",
      "dataColors": [
        "#6366F1",
        "#EC4899",
        "#10B981",
        "#F59E0B",
        "#EF4444",
        "#8B5CF6",
        "#14B8A6",
        "#F97316"
      ]
    },
    "fonts": {
      "title": "Segoe UI",
      "body": "Segoe UI"
    }
  },

  "recommendations": {
    "dataRefresh": {
      "frequency": "Daily",
      "time": "06:00",
      "note": "Synchroniser quotidiennement pour des donn√©es √† jour"
    },
    "filters": [
      {
        "column": "Factures[Date]",
        "type": "Date Range",
        "default": "Last 12 months"
      },
      {
        "column": "Contacts[city]",
        "type": "Slicer",
        "multiSelect": true
      },
      {
        "column": "Projets[pr_state_id]",
        "type": "Dropdown",
        "default": "Active projects"
      }
    ],
    "performance": [
      "Utilisez l'importation de donn√©es plut√¥t que DirectQuery pour de meilleures performances",
      "Cr√©ez des colonnes calcul√©es uniquement si n√©cessaire, privil√©giez les mesures DAX",
      "Limitez les relations bidirectionnelles",
      "Utilisez des agr√©gations pour les grandes tables"
    ]
  },

  "instructions": {
    "step1": "T√©l√©chargez le fichier Excel depuis la page Synchronisation",
    "step2": "Ouvrez Power BI Desktop",
    "step3": "Fichier > Obtenir des donn√©es > Excel",
    "step4": "S√©lectionnez toutes les feuilles et cliquez sur Charger",
    "step5": "Allez dans l'onglet Mod√©lisation pour cr√©er les relations list√©es ci-dessus",
    "step6": "Cr√©ez les mesures DAX en copiant les formules de cette configuration",
    "step7": "Cr√©ez les pages de rapport en suivant les layouts recommand√©s",
    "step8": "Appliquez le th√®me de couleurs",
    "step9": "Publiez sur Power BI Service",
    "step10": "Configurez l'actualisation automatique"
  }
}
